#!/bin/bash

# ===============================================
# KEEPALIVE SCRIPT - –ü–æ–¥–¥—ä—Ä–∂–∞ –±–æ—Ç–∞ –≤–∏–Ω–∞–≥–∏ –∞–∫—Ç–∏–≤–µ–Ω
# ===============================================

echo "üîÑ Keepalive script started"

while true; do
    # –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ bot.py —Ä–∞–±–æ—Ç–∏
    if ! pgrep -f "python.*bot.py" > /dev/null; then
        echo "‚ùå Bot –Ω–µ —Ä–∞–±–æ—Ç–∏! –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–º..."
        
        # –£–±–∏–π –≤—Å–∏—á–∫–∏ —Å—Ç–∞—Ä–∏ –ø—Ä–æ—Ü–µ—Å–∏
        pkill -f "python.*bot.py"
        
        # –ò–∑—á–∞–∫–∞–π 2 —Å–µ–∫—É–Ω–¥–∏
        sleep 2
        
        # –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –æ—Ç–Ω–æ–≤–æ
        cd /workspaces/Crypto-signal-bot
        nohup python3 bot.py > bot.log 2>&1 &
        
        echo "‚úÖ Bot —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω!"
    else
        echo "‚úÖ Bot —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ ($(date))"
    fi
    
    # –ü—Ä–æ–≤–µ—Ä–∏ –Ω–∞ –≤—Å–µ–∫–∏ 30 —Å–µ–∫—É–Ω–¥–∏
    sleep 30
done
