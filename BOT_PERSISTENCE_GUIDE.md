# üîÑ BOT PERSISTENCE & AUTO-RESTART GUIDE

## ‚ùå –ü—Ä–æ–±–ª–µ–º
–ö–æ–≥–∞—Ç–æ Codespace —Å–ø—Ä–µ –∏–ª–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞, –±–æ—Ç—ä—Ç –≥—É–±–∏ callback handlers –∏ –±—É—Ç–æ–Ω–∏—Ç–µ —Å–ø–∏—Ä–∞—Ç –¥–∞ —Ä–∞–±–æ—Ç—è—Ç.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–°—ä–∑–¥–∞–¥–µ–Ω–∏ —Å–∞ **3 –Ω–∏–≤–∞ –Ω–∞ –∑–∞—â–∏—Ç–∞**:

---

## 1Ô∏è‚É£ SUPERVISOR (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω —Ä–µ—Å—Ç–∞—Ä—Ç)

### –ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏:
- –°—Ç–∞—Ä—Ç–∏—Ä–∞ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ crash
- –ë–µ–∑–∫—Ä–∞–π–Ω–∏ –æ–ø–∏—Ç–∏ –∑–∞ —Ä–µ—Å—Ç–∞—Ä—Ç (999999 –ø—ä—Ç–∏)
- –õ–æ–≥–≤–∞ –≤—Å—è–∫–∞ –≥—Ä–µ—à–∫–∞ –≤ `supervisor.log`

### –£–ø–æ—Ç—Ä–µ–±–∞:
```bash
# –î–∏—Ä–µ–∫—Ç–µ–Ω —Å—Ç–∞—Ä—Ç
bash supervisor.sh

# –í—ä–≤ —Ñ–æ–Ω–æ–≤ —Ä–µ–∂–∏–º
nohup bash supervisor.sh > supervisor.log 2>&1 &
```

---

## 2Ô∏è‚É£ KEEPALIVE (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)

### –ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏:
- –ü—Ä–æ–≤–µ—Ä—è–≤–∞ –¥–∞–ª–∏ –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∏ –Ω–∞ –≤—Å–µ–∫–∏ 30 —Å–µ–∫—É–Ω–¥–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ –∞–∫–æ –ø—Ä–æ—Ü–µ—Å—ä—Ç –µ —Å–ø—Ä—è–ª
- –†–∞–±–æ—Ç–∏ –±–µ–∑–∫—Ä–∞–π–Ω–æ

### –£–ø–æ—Ç—Ä–µ–±–∞:
```bash
# –°—Ç–∞—Ä—Ç–∏—Ä–∞–π keepalive
bash keepalive.sh

# –í—ä–≤ —Ñ–æ–Ω–æ–≤ —Ä–µ–∂–∏–º
nohup bash keepalive.sh > keepalive.log 2>&1 &
```

---

## 3Ô∏è‚É£ BOT-SERVICE (Systemd-style —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

### –ö–∞–∫–≤–æ –ø—Ä–∞–≤–∏:
- –£–ø—Ä–∞–≤–ª—è–≤–∞ –±–æ—Ç–∞ –∫–∞—Ç–æ —Å–∏—Å—Ç–µ–º–µ–Ω —Å–µ—Ä–≤–∏–∑
- start/stop/restart/status –∫–æ–º–∞–Ω–¥–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —á–∏—Å—Ç–∏ PID —Ñ–∞–π–ª–æ–≤–µ
- –õ–æ–≥–≤–∞ –≤—Å–∏—á–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –£–ø–æ—Ç—Ä–µ–±–∞:
```bash
# –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞
./bot-service.sh start

# –°–ø—Ä–∏ –±–æ—Ç–∞
./bot-service.sh stop

# –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞
./bot-service.sh restart

# –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å
./bot-service.sh status
```

### –ò–∑—Ö–æ–¥ –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å:
```
‚úÖ Bot is running (PID: 9213)
‚è±Ô∏è  Uptime: 05:32
üíæ Memory: 2.3%
```

---

## üöÄ –ü–†–ï–ü–û–†–™–ß–ê–ù–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### –ó–∞ Codespace (–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–µ—à–µ–Ω–∏–µ):
```bash
# 1. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π bot-service
./bot-service.sh start

# 2. –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—Ç—É—Å
./bot-service.sh status
```

### –ó–∞ Production (Railway.app):
Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ-—Å—Ç–∞—Ä—Ç–∏—Ä–∞ –±–æ—Ç–∞ –ø—Ä–∏ crash –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω–∏–µ –Ω–∞ `railway.json`:
```json
{
  "deploy": {
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 10
  }
}
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–æ–≥–æ–≤–µ:
```bash
# Bot-service –ª–æ–≥
tail -f bot-service.log

# Supervisor –ª–æ–≥
tail -f supervisor.log

# Keepalive –ª–æ–≥
tail -f keepalive.log

# Bot –æ—Å–Ω–æ–≤–µ–Ω –ª–æ–≥
tail -f bot.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—Ü–µ—Å–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∏
ps aux | grep bot.py

# –ü—Ä–æ–≤–µ—Ä–∏ supervisor
ps aux | grep supervisor.sh

# –ü—Ä–æ–≤–µ—Ä–∏ keepalive
ps aux | grep keepalive.sh
```

---

## üîß TROUBLESHOOTING

### –ü—Ä–æ–±–ª–µ–º: –ë—É—Ç–æ–Ω–∏—Ç–µ –Ω–µ —Ä–∞–±–æ—Ç—è—Ç —Å–ª–µ–¥ —Ä–µ—Å—Ç–∞—Ä—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** Callback handlers –Ω–µ —Å–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—ä–ª–µ–Ω —Ä–µ—Å—Ç–∞—Ä—Ç
./bot-service.sh restart

# –ü—Ä–æ–≤–µ—Ä–∏ startup notification –≤ Telegram
# –¢—Ä—è–±–≤–∞ –¥–∞ –≤–∏–¥–∏—à: "‚úÖ Callback handlers: 8 –∞–∫—Ç–∏–≤–Ω–∏"
```

### –ü—Ä–æ–±–ª–µ–º: –ë–æ—Ç —Å–ø–∏—Ä–∞ —Å–ª–µ–¥ –º–∏–Ω—É—Ç–∏

**–ü—Ä–∏—á–∏–Ω–∞:** Codespace auto-sleep —Å–ª–µ–¥ 30 –º–∏–Ω –±–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. **–í—Ä–µ–º–µ–Ω–Ω–æ:** –ò–∑–ø–æ–ª–∑–≤–∞–π keepalive —Å–∫—Ä–∏–ø—Ç–∞
2. **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ:** –î–µ–ø–ª–æ–π–Ω–∏ –Ω–∞ Railway.app (24/7 –±–µ–∑ sleep)

```bash
# –°—Ç–∞—Ä—Ç–∏—Ä–∞–π keepalive
nohup bash keepalive.sh > keepalive.log 2>&1 &
```

### –ü—Ä–æ–±–ª–µ–º: Multiple bot instances

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–æ—Ç–∞ –µ —Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω –Ω—è–∫–æ–ª–∫–æ –ø—ä—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–∏–π –≤—Å–∏—á–∫–∏ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏
pkill -f "python.*bot.py"

# –ü–æ—á–∏—Å—Ç–∏ PID —Ñ–∞–π–ª
rm -f bot.pid

# –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –æ—Ç–Ω–æ–≤–æ
./bot-service.sh start
```

---

## üéØ CALLBACK HANDLERS

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–∏ callback handlers:
- ‚úÖ `signal_BTCUSDT` - BTC —Å–∏–≥–Ω–∞–ª –±—É—Ç–æ–Ω
- ‚úÖ `signal_ETHUSDT` - ETH —Å–∏–≥–Ω–∞–ª –±—É—Ç–æ–Ω  
- ‚úÖ `signal_SOLUSDT` - SOL —Å–∏–≥–Ω–∞–ª –±—É—Ç–æ–Ω
- ‚úÖ `timeframe_15m` - –¢–∞–π–º—Ñ—Ä–µ–π–º 15–º
- ‚úÖ `timeframe_1h` - –¢–∞–π–º—Ñ—Ä–µ–π–º 1—á
- ‚úÖ `reports_daily` - –î–Ω–µ–≤–µ–Ω –æ—Ç—á–µ—Ç
- ‚úÖ `ml_train` - ML –æ–±—É—á–µ–Ω–∏–µ
- ‚úÖ `backtest_run` - Backtesting

### –¢–µ—Å—Ç –Ω–∞ –±—É—Ç–æ–Ω–∏—Ç–µ:
1. –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞: `./bot-service.sh start`
2. –ò–∑—á–∞–∫–∞–π 3 —Å–µ–∫—É–Ω–¥–∏ –∑–∞ startup notification
3. –ù–∞—Ç–∏—Å–Ω–∏ –Ω—è–∫–æ–π –±—É—Ç–æ–Ω –≤ Telegram
4. –ü—Ä–æ–≤–µ—Ä–∏ –ª–æ–≥–æ–≤–µ—Ç–µ: `tail -f bot.log`

---

## üì± STARTUP NOTIFICATION

–ü—Ä–∏ –≤—Å–µ–∫–∏ —Ä–µ—Å—Ç–∞—Ä—Ç –ø–æ–ª—É—á–∞–≤–∞—à Telegram —Å—ä–æ–±—â–µ–Ω–∏–µ:

```
üîÑ BOT RESTARTED

üïí –í—Ä–µ–º–µ: 2025-11-23 21:45:32

‚úÖ –í—Å–∏—á–∫–∏ handlers —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–∏
‚úÖ Callback handlers: 8 –∞–∫—Ç–∏–≤–Ω–∏
‚úÖ –ë—É—Ç–æ–Ω–∏—Ç–µ —Å–∞ –∞–∫—Ç–∏–≤–Ω–∏
‚úÖ Auto-alerts –≤–∫–ª—é—á–µ–Ω–∏ (5 –º–∏–Ω)
‚úÖ Daily reports –∞–∫—Ç–∏–≤–Ω–∏ (20:00)
‚úÖ ML Engine –≥–æ—Ç–æ–≤
‚úÖ Backtesting –≥–æ—Ç–æ–≤

ü§ñ –ë–æ—Ç—ä—Ç —Ä–∞–±–æ—Ç–∏ –Ω–æ—Ä–º–∞–ª–Ω–æ!

–í—Å–∏—á–∫–∏ –±—É—Ç–æ–Ω–∏ —Å–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–∏ –∏ –≥–æ—Ç–æ–≤–∏ –∑–∞ —É–ø–æ—Ç—Ä–µ–±–∞.
```

–ê–∫–æ –ø–æ–ª—É—á–∏—à —Ç–æ–≤–∞ —Å—ä–æ–±—â–µ–Ω–∏–µ = –±—É—Ç–æ–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—è—Ç!

---

## üåê PRODUCTION DEPLOYMENT

### Railway.app (–ü—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ):

1. **Deploy –≤–µ–¥–Ω—ä–∂:**
   ```bash
   # Push to GitHub
   git add .
   git commit -m "Deploy to Railway"
   git push origin main
   ```

2. **Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:**
   - –°—Ç–∞—Ä—Ç–∏—Ä–∞ –±–æ—Ç–∞ –ø—Ä–∏ deploy
   - –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ –ø—Ä–∏ crash (–¥–æ 10 –ø—ä—Ç–∏)
   - –ó–∞–ø–∞–∑–≤–∞ bot.pid –∏ persistence —Ñ–∞–π–ª–æ–≤–µ
   - –ù—è–º–∞ sleep mode
   - 500h free –º–µ—Å–µ—á–Ω–æ

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - Railway Dashboard ‚Üí Logs
   - Telegram startup notifications
   - Auto-alerts –Ω–∞ –≤—Å–µ–∫–∏ 5 –º–∏–Ω—É—Ç–∏

### –ö—Ä–∞–π –Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ä–µ—Å—Ç–∞—Ä—Ç–∏:
‚úÖ –ë–æ—Ç–∞ —Ä–∞–±–æ—Ç–∏ 24/7  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω restart –ø—Ä–∏ crash  
‚úÖ Persistent storage  
‚úÖ –ë—É—Ç–æ–Ω–∏—Ç–µ –≤–∏–Ω–∞–≥–∏ —Ä–∞–±–æ—Ç—è—Ç  

---

## üìû –ü–û–î–î–†–™–ñ–ö–ê

### –ë—ä—Ä–∑–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞ check:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏ –≤—Å–∏—á–∫–æ –Ω–∞–≤–µ–¥–Ω—ä–∂
echo "=== BOT STATUS ===" && \
./bot-service.sh status && \
echo "" && \
echo "=== RECENT LOGS ===" && \
tail -n 5 bot.log
```

### Auto-start –ø—Ä–∏ login (Codespace):
–î–æ–±–∞–≤–∏ –≤ `~/.bashrc`:
```bash
# Auto-start bot service
cd /workspaces/Crypto-signal-bot
./bot-service.sh status || ./bot-service.sh start
```

---

## ‚úÖ –ì–û–¢–û–í–û!

–°–µ–≥–∞ –±–æ—Ç—ä—Ç –∏–º–∞ **3-—Å–ª–æ–π–Ω–∞ –∑–∞—â–∏—Ç–∞** —Å—Ä–µ—â—É crash-–æ–≤–µ:
1. **Supervisor** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω restart
2. **Keepalive** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –ø—Ä–æ—Ü–µ—Å–∞
3. **Bot-service** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–æ —Å–∏—Å—Ç–µ–º–µ–Ω —Å–µ—Ä–≤–∏–∑

**–†–µ–∑—É–ª—Ç–∞—Ç:** –ë—É—Ç–æ–Ω–∏—Ç–µ –≤–∏–Ω–∞–≥–∏ —Ä–∞–±–æ—Ç—è—Ç —Å–ª–µ–¥ —Ä–µ—Å—Ç–∞—Ä—Ç! üéâ
