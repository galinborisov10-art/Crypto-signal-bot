# üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ü—Ä–æ–±–ª–µ–º —Å –¥—É–±–ª–∏—Ä–∞–Ω–µ –Ω–∞ –±–ª–∏–∑–∫–∏ —Å–∏–≥–Ω–∞–ª–∏

## üìä –ê–ù–ê–õ–ò–ó –ù–ê –¢–ï–ö–£–©–û–¢–û –°–™–°–¢–û–Ø–ù–ò–ï

### 1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∏ `is_signal_already_sent()`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bot.py:419-467`

**–¢–µ–∫—É—â–∞—Ç–∞ –ª–æ–≥–∏–∫–∞:**

```python
def is_signal_already_sent(symbol, signal_type, timeframe, confidence, cooldown_minutes=60):
    global SENT_SIGNALS_CACHE
    
    # –°—ä–∑–¥–∞–π —É–Ω–∏–∫–∞–ª–µ–Ω –∫–ª—é—á –∑–∞ —Å–∏–≥–Ω–∞–ª–∞
    signal_key = f"{symbol}_{signal_type}_{timeframe}"
    
    current_time = datetime.now()
    
    # –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ —Ç–æ–∑–∏ —Å–∏–≥–Ω–∞–ª –µ –∏–∑–ø—Ä–∞—â–∞–Ω –Ω–∞—Å–∫–æ—Ä–æ
    if signal_key in SENT_SIGNALS_CACHE:
        last_sent_time = SENT_SIGNALS_CACHE[signal_key]['timestamp']
        last_confidence = SENT_SIGNALS_CACHE[signal_key]['confidence']
        
        # –ò–∑—á–∏—Å–ª–∏ –∫–æ–ª–∫–æ –≤—Ä–µ–º–µ –µ –º–∏–Ω–∞–ª–æ
        time_diff = (current_time - last_sent_time).total_seconds() / 60  # –≤ –º–∏–Ω—É—Ç–∏
        
        # –ê–∫–æ –µ –º–∏–Ω–∞–ª–æ –ø–æ-–º–∞–ª–∫–æ –æ—Ç cooldown –≤—Ä–µ–º–µ, –Ω–µ –∏–∑–ø—Ä–∞—â–∞–π
        if time_diff < cooldown_minutes:
            return True
        
        # –ê–∫–æ confidence –µ –ø–æ—á—Ç–∏ —Å—ä—â–∏—è—Ç (¬±5%), —Å—ä—â–æ –Ω–µ –∏–∑–ø—Ä–∞—â–∞–π
        if abs(confidence - last_confidence) < 5 and time_diff < cooldown_minutes * 2:
            return True
    
    # –ó–∞–ø–∞–∑–∏ –Ω–æ–≤–∏—è —Å–∏–≥–Ω–∞–ª –≤ –∫–µ—à–∞
    SENT_SIGNALS_CACHE[signal_key] = {
        'timestamp': current_time,
        'confidence': confidence
    }
    
    return False
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ `SENT_SIGNALS_CACHE`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bot.py:221`

```python
SENT_SIGNALS_CACHE = {}

# –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
{
    "BTCUSDT_BUY_4h": {
        'timestamp': datetime(2025, 12, 11, 10, 0, 0),
        'confidence': 75
    },
    "BTCUSDT_SELL_4h": {
        'timestamp': datetime(2025, 12, 11, 11, 30, 0),
        'confidence': 82
    }
}
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ö–µ—à—ä—Ç –µ —Å–∞–º–æ –≤ –ø–∞–º–µ—Ç—Ç–∞ (RAM) –∏ **–ù–ï –°–ï –ó–ê–ü–ò–°–í–ê –Ω–∞ –¥–∏—Å–∫**. –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –±–æ—Ç–∞ —Å–µ –∏–∑—á–∏—Å—Ç–≤–∞.

### 3. –ö—ä–¥–µ —Å–µ –∏–∑–≤–∏–∫–≤–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ç–∞?

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bot.py:7080`

```python
async def send_alert_signal(context: ContextTypes.DEFAULT_TYPE):
    # ... –∞–Ω–∞–ª–∏–∑ –Ω–∞ –ø–∞–∑–∞—Ä–∞ ...
    
    # ‚ö° –ü–†–û–í–ï–†–ö–ê –ó–ê –î–£–ë–õ–ò–†–ê–ù–ï (–∏–∑–≤–∏–∫–≤–∞ —Å–µ –í–ï–î–ù–™–ñ –∑–∞ –≤—Å–µ–∫–∏ symbol+timeframe)
    if is_signal_already_sent(symbol, analysis['signal'], timeframe, analysis['confidence'], cooldown_minutes=60):
        return None  # –ü—Ä–æ–ø—É—Å–∫–∞ —Å–∏–≥–Ω–∞–ª–∞
    
    # ... –ø—Ä–æ–¥—ä–ª–∂–∞–≤–∞ —Å –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Å–∏–≥–Ω–∞–ª–∞ ...
```

### 4. –ö–∞–∫ —Å–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞—Ç —Å–∏–≥–Ω–∞–ª–∏—Ç–µ?

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `bot.py:7044-7300`

**Workflow:**

1. **–ü–∞—Ä–∞–ª–µ–ª–µ–Ω –∞–Ω–∞–ª–∏–∑** (bot.py:7054-7178)
   - –ü—Ä–æ–≤–µ—Ä—è–≤–∞—Ç —Å–µ –≤—Å–∏—á–∫–∏ –º–æ–Ω–µ—Ç–∏ (BTCUSDT, ETHUSDT, –∏ —Ç.–Ω.)
   - –ó–∞ –≤—Å—è–∫–∞ –º–æ–Ω–µ—Ç–∞ —Å–µ –ø—Ä–æ–≤–µ—Ä—è–≤–∞—Ç –≤—Å–∏—á–∫–∏ timeframes (1h, 4h, 1d)
   - –ê–Ω–∞–ª–∏–∑—ä—Ç —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞ –ø–∞—Ä–∞–ª–µ–ª–Ω–æ (asyncio.gather)

2. **–ê–Ω–∞–ª–∏–∑ –Ω–∞ –≤—Å—è–∫–∞ –¥–≤–æ–π–∫–∞** (analyze_single_pair)
   - –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ klines –¥–∞–Ω–Ω–∏
   - –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ (RSI, Bollinger Bands, Volume)
   - **LuxAlgo + ICT –∞–Ω–∞–ª–∏–∑** (Support/Resistance, Market Structure Shift, FVG, Liquidity Grabs)
   - ML –≤–∞–ª–∏–¥–∞—Ü–∏—è (–∞–∫–æ –µ –Ω–∞–ª–∏—á–Ω–∞)
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ —Å–ª–µ–¥ –∞–Ω–∞–ª–∏–∑–∞** (line 7080)

3. **–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ confidence** (bot.py:3167-3450)
   - –ë–∞–∑–æ–≤ confidence: 50
   - LuxAlgo S/R: +15
   - ICT MSS: +30
   - ICT Liquidity Grab: +25
   - ICT FVG: +18
   - ICT Displacement: +15
   - ICT OTE: +20
   - Candlestick patterns: –ø—Ä–æ–º–µ–Ω–ª–∏–≤ boost
   - Volume: –ø—Ä–æ–º–µ–Ω–ª–∏–≤ boost
   - ML validation: –ø—Ä–æ–º–µ–Ω–ª–∏–≤ boost/penalty
   - **–§–∏–Ω–∞–ª–µ–Ω confidence –º–æ–∂–µ –¥–∞ –≤–∞—Ä–∏—Ä–∞ –∑–Ω–∞—á–∏—Ç–µ–ª–Ω–æ –ø—Ä–∏ –≤—Å–µ–∫–∏ –∞–Ω–∞–ª–∏–∑**

---

## üî¥ –î–ò–ê–ì–ù–û–ó–ê: –ó–∞—â–æ —Å–µ –ø–æ—è–≤—è–≤–∞—Ç –¥—É–±–ª–∏—Ä–∞–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏?

### –û–°–ù–û–í–ï–ù –ü–†–û–ë–õ–ï–ú: **–ö–ª—é—á—ä—Ç –∑–∞ —É–Ω–∏–∫–∞–ª–Ω–æ—Å—Ç –Ω–µ –≤–∫–ª—é—á–≤–∞ –¶–ï–ù–ê–¢–ê**

**–¢–µ–∫—É—â –∫–ª—é—á:**
```python
signal_key = f"{symbol}_{signal_type}_{timeframe}"
# –ü—Ä–∏–º–µ—Ä: "BTCUSDT_SELL_4h"
```

**–ü—Ä–æ–±–ª–µ–º—ä—Ç:**

–ö–æ–≥–∞—Ç–æ –±–æ—Ç—ä—Ç —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –∏–ª–∏ —Å–ª–µ–¥ cleanup (24 —á–∞—Å–∞), –∫–µ—à—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω. –°–ª–µ–¥ —Ç–æ–≤–∞:

1. **10:00** - –ü—ä—Ä–≤–∏ –∞–Ω–∞–ª–∏–∑: BTCUSDT SELL 4h @ 97100 USD (confidence 75%) ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù
   - –ö–ª—é—á: `BTCUSDT_SELL_4h`
   - –ö–µ—à: `{'timestamp': 10:00, 'confidence': 75}`

2. **10:15** - –í—Ç–æ—Ä–∏ –∞–Ω–∞–ª–∏–∑: BTCUSDT SELL 4h @ 97095 USD (confidence 76%) ‚ùå –ë–õ–û–ö–ò–†–ê–ù
   - –°—ä—â–∏—è—Ç –∫–ª—é—á: `BTCUSDT_SELL_4h`
   - time_diff = 15 –º–∏–Ω—É—Ç–∏ < 60 –º–∏–Ω—É—Ç–∏ cooldown
   - **–ë–õ–û–ö–ò–†–ê–ù –ü–†–ê–í–ò–õ–ù–û** ‚úÖ

3. **11:15** - –¢—Ä–µ—Ç–∏ –∞–Ω–∞–ª–∏–∑: BTCUSDT SELL 4h @ 97102 USD (confidence 77%) ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù
   - –°—ä—â–∏—è—Ç –∫–ª—é—á: `BTCUSDT_SELL_4h`
   - time_diff = 75 –º–∏–Ω—É—Ç–∏ > 60 –º–∏–Ω—É—Ç–∏ cooldown
   - **–ü–†–û–ü–£–°–ö–ê –°–ï** - cooldown –∏–∑—Ç–µ–∫—ä–ª

**–†–µ–∑—É–ª—Ç–∞—Ç:** –¢—Ä–∏ –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–∏ —Å–∏–≥–Ω–∞–ª–∞ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –≤ —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ 1-2 —á–∞—Å–∞!

---

### –î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –§–ê–ö–¢–û–†–ò, –ö–û–ò–¢–û –°–™–ó–î–ê–í–ê–¢ –ü–†–û–ë–õ–ï–ú–ê:

#### 1. **Confidence –≤–∏–Ω–∞–≥–∏ –≤–∞—Ä–∏—Ä–∞**

Confidence —Å–µ –∏–∑—á–∏—Å–ª—è–≤–∞ –¥–∏–Ω–∞–º–∏—á–Ω–æ –∏ –∑–∞–≤–∏—Å–∏ –æ—Ç:
- RSI (–º–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–æ–º–µ–Ω–∏ —Å 1-2 —Ç–æ—á–∫–∏ –º–µ–∂–¥—É –∞–Ω–∞–ª–∏–∑–∏—Ç–µ)
- Volume ratio (–º–æ–∂–µ –¥–∞ –≤–∞—Ä–∏—Ä–∞)
- LuxAlgo S/R (–º–æ–∂–µ –¥–∞ —Å–µ –ø—Ä–æ–º–µ–Ω–∏ breakout —Å—Ç–∞—Ç—É—Å–∞)
- ICT –∞–Ω–∞–ª–∏–∑ (MSS, FVG, Liquidity Grabs —Å–µ –ø—Ä–æ–º–µ–Ω—è—Ç)
- ML prediction (–º–æ–∂–µ –¥–∞ –¥–∞–¥–µ —Ä–∞–∑–ª–∏—á–µ–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç)
- Candlestick patterns (–º–æ–≥–∞—Ç –¥–∞ —Å–µ –ø–æ—è–≤—è—Ç –Ω–æ–≤–∏)

**–†–µ–∑—É–ª—Ç–∞—Ç:** Confidence –º–æ–∂–µ –¥–∞ –≤–∞—Ä–∏—Ä–∞ –º–µ–∂–¥—É 70% –∏ 85% –∑–∞ **–°–™–©–ò–Ø –°–ò–ì–ù–ê–õ** –≤ —Ä–∞–∑–ª–∏—á–Ω–æ –≤—Ä–µ–º–µ.

**–¢–µ–∫—É—â–∞ –∑–∞—â–∏—Ç–∞:** 
```python
if abs(confidence - last_confidence) < 5 and time_diff < cooldown_minutes * 2:
    return True  # –ë–ª–æ–∫–∏—Ä–∞ —Å–∏–≥–Ω–∞–ª–∞
```

–¢–æ–≤–∞ —Ä–∞–±–æ—Ç–∏ **–°–ê–ú–û** –∞–∫–æ:
- Confidence —Å–µ —Ä–∞–∑–ª–∏—á–∞–≤–∞ —Å –ø–æ-–º–∞–ª–∫–æ –æ—Ç 5%
- –ò time_diff < 120 –º–∏–Ω—É—Ç–∏ (2x cooldown)

**–ü—Ä–æ–±–ª–µ–º:** –ê–∫–æ confidence —Å–µ –ø—Ä–æ–º–µ–Ω–∏ —Å 6% –∏–ª–∏ –ø–æ–≤–µ—á–µ, —Å–∏–≥–Ω–∞–ª—ä—Ç —â–µ –º–∏–Ω–µ!

#### 2. **–¶–µ–Ω–∞—Ç–∞ –≤–∏–Ω–∞–≥–∏ —Å–µ –ø—Ä–æ–º–µ–Ω—è**

–ü—Ä–∏ –≤—Å–µ–∫–∏ –∞–Ω–∞–ª–∏–∑, —Ü–µ–Ω–∞—Ç–∞ –µ —Ç–µ–∫—É—â–∞—Ç–∞ —Ü–µ–Ω–∞ –æ—Ç Binance:
```python
current_price = closes[-1]  # –ü–æ—Å–ª–µ–¥–Ω–∞—Ç–∞ —Å–≤–µ—â
```

**–ü—Ä–∏–º–µ—Ä:**
- 10:00: BTCUSDT @ 97100
- 10:15: BTCUSDT @ 97095
- 10:30: BTCUSDT @ 97102
- 10:45: BTCUSDT @ 97088

–í—Å–∏—á–∫–∏ —Ç–µ —Å–∞ **–†–ê–ó–õ–ò–ß–ù–ò** —Ü–µ–Ω–∏, –Ω–æ —Ä–∞–∑–ª–∏–∫–∞—Ç–∞ –µ –º–∏–Ω–∏–º–∞–ª–Ω–∞ (0.05%-0.1%).

**–¢–µ–∫—É—â–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞:** –ù–Ø–ú–ê –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –±–ª–∏–∑–æ—Å—Ç –Ω–∞ —Ü–µ–Ω–∏—Ç–µ!

#### 3. **Timestamp –≤–∏–Ω–∞–≥–∏ –µ —Ä–∞–∑–ª–∏—á–µ–Ω**

Timestamp —Å–µ –∑–∞–ø–∏—Å–≤–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç `datetime.now()` –ø—Ä–∏ –≤—Å–µ–∫–∏ –∞–Ω–∞–ª–∏–∑.

**–ü—Ä–æ–±–ª–µ–º:** –°–ª–µ–¥ –∫–∞—Ç–æ cooldown –∏–∑—Ç–µ—á–µ (60 –º–∏–Ω), —Å–∏–≥–Ω–∞–ª—ä—Ç —â–µ –±—ä–¥–µ –∏–∑–ø—Ä–∞—Ç–µ–Ω –æ—Ç–Ω–æ–≤–æ, –¥–æ—Ä–∏ –∞–∫–æ —Ü–µ–Ω–∞—Ç–∞ –µ **–°–™–©–ê–¢–ê** (¬±0.1%).

#### 4. **–†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –±–æ—Ç–∞**

–ê–∫–æ –±–æ—Ç—ä—Ç —Å–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞, `SENT_SIGNALS_CACHE` —Å–µ –∏–∑—á–∏—Å—Ç–≤–∞ (–Ω—è–º–∞ persistence –Ω–∞ –¥–∏—Å–∫).

**–†–µ–∑—É–ª—Ç–∞—Ç:** –í—Å–∏—á–∫–∏ —Å–∏–≥–Ω–∞–ª–∏ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç –æ—Ç–Ω–æ–≤–æ, –¥–æ—Ä–∏ –∞–∫–æ —Å–∞ –±–∏–ª–∏ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∏ –ø—Ä–µ–¥–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞!

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–û:** –ù—è–º–∞ —Ñ–∞–π–ª –∫–∞—Ç–æ `sent_signals_cache.json` –∑–∞ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç.

#### 5. **ML –∏ Backtest –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ**

**ML Predictor:** `ml_predictor.py`
- ML –º–æ–¥–µ–ª—ä—Ç –º–æ–∂–µ –¥–∞ –¥–∞–¥–µ –ª–µ–∫–æ —Ä–∞–∑–ª–∏—á–µ–Ω confidence –ø—Ä–∏ –≤—Å—è–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑–≤–∞–Ω–µ
- –ó–∞–≤–∏—Å–∏ –æ—Ç –≤—Ö–æ–¥–Ω–∏—Ç–µ features (RSI, volume_ratio, volatility)
- –ú–æ–∂–µ –¥–∞ —Å–µ –æ–±—É—á–∏ —Å –Ω–æ–≤–∏ –¥–∞–Ω–Ω–∏ –∏ –¥–∞ –ø—Ä–æ–º–µ–Ω–∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ç–µ

**Backtest:** `backtest_results.json`
- Backtest —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ —Å–∞ **–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏** –∏ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–∞—Ç —Ä–µ–∞–ª–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏
- –ò–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ —Å–∞–º–æ –∑–∞ –∞–Ω–∞–ª–∏–∑ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** ML **–ù–ï** –µ –æ—Å–Ω–æ–≤–Ω–∏—è—Ç –∏–∑—Ç–æ—á–Ω–∏–∫ –Ω–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ, –Ω–æ –º–æ–∂–µ –¥–∞ –¥–æ–ø—Ä–∏–Ω–æ—Å–∏ –∑–∞ –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤ confidence.

---

## üìå –¢–û–ß–ù–ê –ü–†–ò–ß–ò–ù–ê –ó–ê –ü–†–û–ë–õ–ï–ú–ê

### **–§–∞–∫—Ç–æ—Ä–∏, –∫–æ–∏—Ç–æ –∫–∞—Ä–∞—Ç –±–æ—Ç–∞ –¥–∞ —Å–º—è—Ç–∞ —Å–∏–≥–Ω–∞–ª–∏—Ç–µ –∑–∞ —Ä–∞–∑–ª–∏—á–Ω–∏:**

| –§–∞–∫—Ç–æ—Ä | –í–ª–∏—è–Ω–∏–µ | –¢–µ–∫—É—â–∞ –∑–∞—â–∏—Ç–∞ | –ü—Ä–æ–±–ª–µ–º |
|--------|---------|---------------|---------|
| **Timestamp** | ‚ö†Ô∏è –í–∏—Å–æ–∫ | Cooldown 60 –º–∏–Ω | –°–ª–µ–¥ cooldown, —Å–∏–≥–Ω–∞–ª—ä—Ç —Å–µ –∏–∑–ø—Ä–∞—â–∞ –æ—Ç–Ω–æ–≤–æ |
| **Price** | üî¥ **–ö–†–ò–¢–ò–ß–ï–ù** | **–ù–Ø–ú–ê** | –¶–µ–Ω–∞—Ç–∞ –≤–∏–Ω–∞–≥–∏ —Å–µ –ø—Ä–æ–º–µ–Ω—è —Å 0.05-0.2% |
| **Confidence** | ‚ö†Ô∏è –í–∏—Å–æ–∫ | ¬±5% tolerance + 2x cooldown | –ê–∫–æ —Å–µ –ø—Ä–æ–º–µ–Ω–∏ >5%, —Å–∏–≥–Ω–∞–ª—ä—Ç –º–∏–Ω–∞–≤–∞ |
| **Signal Type** | ‚úÖ –ù–æ—Ä–º–∞–ª–µ–Ω | –ö–ª—é—á –≤–∫–ª—é—á–≤–∞ type | –†–∞–±–æ—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ |
| **Timeframe** | ‚úÖ –ù–æ—Ä–º–∞–ª–µ–Ω | –ö–ª—é—á –≤–∫–ª—é—á–≤–∞ timeframe | –†–∞–±–æ—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ |
| **Symbol** | ‚úÖ –ù–æ—Ä–º–∞–ª–µ–Ω | –ö–ª—é—á –≤–∫–ª—é—á–≤–∞ symbol | –†–∞–±–æ—Ç–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ |
| **Rounding/Precision** | üü° –ú–∏–Ω–∏–º–∞–ª–µ–Ω | –ù–Ø–ú–ê | –¶–µ–Ω–∞—Ç–∞ –µ float, –º–æ–∂–µ –¥–∞ –∏–º–∞ –º–∞–ª–∫–∏ —Ä–∞–∑–ª–∏–∫–∏ |
| **ML Variance** | üü° –ú–∏–Ω–∏–º–∞–ª–µ–Ω | ¬±5% confidence | ML –º–æ–∂–µ –¥–∞ –ø—Ä–∏—á–∏–Ω–∏ 3-5% –≤–∞—Ä–∏–∞—Ü–∏—è |

### **–û—Å–Ω–æ–≤–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞:**

**–¶–ï–ù–ê–¢–ê –ù–ï –°–ï –í–ó–ò–ú–ê –ü–û–î –í–ù–ò–ú–ê–ù–ò–ï –ü–†–ò –ü–†–û–í–ï–†–ö–ê –ó–ê –î–£–ë–õ–ò–†–ê–ù–ï!**

–î–≤–∞ —Å–∏–≥–Ω–∞–ª–∞ —Å–µ —Å—á–∏—Ç–∞—Ç –∑–∞ **–†–ê–ó–õ–ò–ß–ù–ò**, –∞–∫–æ:
1. Cooldown –µ –∏–∑—Ç–µ–∫—ä–ª (>60 –º–∏–Ω)
2. –ò–õ–ò confidence —Å–µ –µ –ø—Ä–æ–º–µ–Ω–∏–ª –∑–Ω–∞—á–∏—Ç–µ–ª–Ω–æ (>5%)

–ù–æ **–¶–ï–ù–ê–¢–ê –ù–ï –°–ï –ü–†–û–í–ï–†–Ø–í–ê**!

---

## üí° –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï –ó–ê –†–ï–®–ï–ù–ò–ï: "–£–º–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –±–ª–∏–∑–æ—Å—Ç"

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–í–º–µ—Å—Ç–æ –¥–∞ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ —Å–∞–º–æ `symbol + signal_type + timeframe`, —Ç—Ä—è–±–≤–∞ –¥–∞ –ø—Ä–æ–≤–µ—Ä—è–≤–∞–º–µ –∏ **–±–ª–∏–∑–æ—Å—Ç—Ç–∞ –Ω–∞ —Ü–µ–Ω–∞—Ç–∞**.

### –ù–æ–≤ –º–µ—Ö–∞–Ω–∏–∑—ä–º

```python
def is_signal_already_sent_smart(symbol, signal_type, timeframe, confidence, entry_price, cooldown_minutes=60):
    """
    –£–º–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ:
    - –ò–∑–ø–æ–ª–∑–≤–∞ symbol + timeframe + type –∫–∞—Ç–æ –æ—Å–Ω–æ–≤–µ–Ω –∫–ª—é—á
    - –î–æ–ø—É—Å–∫–∞ –º–∞–ª–∫–∏ —Ä–∞–∑–ª–∏–∫–∏ –≤ —Ü–µ–Ω–∞—Ç–∞ (–¥–æ 0.5% –∏–ª–∏ 10 USD)
    - –î–æ–ø—É—Å–∫–∞ –º–∞–ª–∫–∏ —Ä–∞–∑–ª–∏–∫–∏ –≤—ä–≤ –≤—Ä–µ–º–µ—Ç–æ (–¥–æ 5 –º–∏–Ω—É—Ç–∏ –∑–∞ instant check)
    - Cooldown –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ: 60 –º–∏–Ω—É—Ç–∏
    """
    global SENT_SIGNALS_CACHE
    
    # –û—Å–Ω–æ–≤–µ–Ω –∫–ª—é—á (–±–µ–∑ —Ü–µ–Ω–∞)
    base_key = f"{symbol}_{signal_type}_{timeframe}"
    
    current_time = datetime.now()
    
    # –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ –∏–º–∞ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏ –∑–∞ —Ç–æ–∑–∏ –∫–ª—é—á
    if base_key in SENT_SIGNALS_CACHE:
        last_sent = SENT_SIGNALS_CACHE[base_key]
        last_time = last_sent['timestamp']
        last_confidence = last_sent['confidence']
        last_price = last_sent['entry_price']  # üÜï –ù–û–í–ê –ü–†–û–í–ï–†–ö–ê
        
        # 1. –ò–∑—á–∏—Å–ª–∏ –≤—Ä–µ–º–µ–≤–∏ —Ä–∞–∑–ª–∏–∫–∏
        time_diff_minutes = (current_time - last_time).total_seconds() / 60
        
        # 2. –ò–∑—á–∏—Å–ª–∏ —Ü–µ–Ω–æ–≤–∞ —Ä–∞–∑–ª–∏–∫–∞ (–ø—Ä–æ—Ü–µ–Ω—Ç)
        price_diff_pct = abs((entry_price - last_price) / last_price) * 100
        
        # 3. –ò–∑—á–∏—Å–ª–∏ confidence —Ä–∞–∑–ª–∏–∫–∞
        confidence_diff = abs(confidence - last_confidence)
        
        # === –ü–†–ê–í–ò–õ–ê –ó–ê –ë–õ–û–ö–ò–†–ê–ù–ï ===
        
        # –ü–†–ê–í–ò–õ–û 1: Cooldown –Ω–µ –µ –∏–∑—Ç–µ–∫—ä–ª + —Ü–µ–Ω–∞—Ç–∞ –µ –±–ª–∏–∑–∫–∞ (< 0.5%)
        if time_diff_minutes < cooldown_minutes and price_diff_pct < 0.5:
            logger.info(f"‚è≠Ô∏è Skip {base_key}: Cooldown active ({time_diff_minutes:.1f}m) + Price close ({price_diff_pct:.2f}%)")
            return True
        
        # –ü–†–ê–í–ò–õ–û 2: –¶–µ–Ω–∞—Ç–∞ –µ –ú–ù–û–ì–û –±–ª–∏–∑–∫–∞ (< 0.2%) + –º–∞–ª–∫–æ –≤—Ä–µ–º–µ –µ –º–∏–Ω–∞–ª–æ (< 2x cooldown)
        if price_diff_pct < 0.2 and time_diff_minutes < cooldown_minutes * 2:
            logger.info(f"‚è≠Ô∏è Skip {base_key}: Price very close ({price_diff_pct:.2f}%) within 2h")
            return True
        
        # –ü–†–ê–í–ò–õ–û 3: Confidence –µ –ø–æ—á—Ç–∏ —Å—ä—â (< 5%) + —Ü–µ–Ω–∞—Ç–∞ –µ –±–ª–∏–∑–∫–∞ (< 1%) + cooldown –Ω–µ –µ –Ω–∞–ø—ä–ª–Ω–æ –∏–∑—Ç–µ–∫—ä–ª
        if confidence_diff < 5 and price_diff_pct < 1.0 and time_diff_minutes < cooldown_minutes * 1.5:
            logger.info(f"‚è≠Ô∏è Skip {base_key}: Similar confidence ({confidence}% vs {last_confidence}%) + Price close ({price_diff_pct:.2f}%)")
            return True
        
        # –ü–†–ê–í–ò–õ–û 4: –ê–∫–æ –≤—Å–∏—á–∫–æ –µ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ (confidence ~—Å—ä—â, —Ü–µ–Ω–∞ ~—Å—ä—â–∞) –≤ —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ 4 —á–∞—Å–∞
        if confidence_diff < 3 and price_diff_pct < 0.3 and time_diff_minutes < 240:
            logger.info(f"‚è≠Ô∏è Skip {base_key}: Almost identical signal within 4h")
            return True
    
    # –ó–∞–ø–∞–∑–∏ –Ω–æ–≤–∏—è —Å–∏–≥–Ω–∞–ª –≤ –∫–µ—à–∞ (–≤–∫–ª—é—á–≤–∞ –∏ —Ü–µ–Ω–∞—Ç–∞)
    SENT_SIGNALS_CACHE[base_key] = {
        'timestamp': current_time,
        'confidence': confidence,
        'entry_price': entry_price  # üÜï –ó–ê–ü–ê–ó–ò –¶–ï–ù–ê–¢–ê
    }
    
    logger.info(f"‚úÖ New signal: {base_key} @ ${entry_price:.2f} ({confidence}%)")
    return False
```

### –ö–ª—é—á–æ–≤–∏ –ø—Ä–æ–º–µ–Ω–∏

1. **–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ `entry_price` –≤ –∫–µ—à–∞**
   ```python
   SENT_SIGNALS_CACHE[base_key] = {
       'timestamp': current_time,
       'confidence': confidence,
       'entry_price': entry_price  # üÜï
   }
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –±–ª–∏–∑–æ—Å—Ç –Ω–∞ —Ü–µ–Ω–∞—Ç–∞**
   - < 0.2%: –ú–ù–û–ì–û –±–ª–∏–∑–∫–∞ (–±–ª–æ–∫–∏—Ä–∞ –≤ —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ 2h)
   - < 0.5%: –ë–ª–∏–∑–∫–∞ (–±–ª–æ–∫–∏—Ä–∞ –≤ —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ cooldown)
   - < 1.0%: –û—Ç–Ω–æ—Å–∏—Ç–µ–ª–Ω–æ –±–ª–∏–∑–∫–∞ (–±–ª–æ–∫–∏—Ä–∞ –∞–∫–æ confidence –µ —Å—ä—â)

3. **Multi-factor –ø—Ä–æ–≤–µ—Ä–∫–∞**
   - –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –æ—Ç –≤—Ä–µ–º–µ + —Ü–µ–Ω–∞ + confidence
   - –ü–æ-—Å—Ç—Ä–∏–∫—Ç–Ω–∞ –∑–∞ –ø–æ-–∫—Ä–∞—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–∏
   - –ü–æ-—Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–∞ –∑–∞ –ø–æ-–¥—ä–ª–≥–∏ –ø–µ—Ä–∏–æ–¥–∏

4. **–ì—ä–≤–∫–∞–≤–∏ –ø—Ä–∞–≥–æ–≤–µ**
   - 0.5% —Ü–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç (–Ω–∞—Å—Ç—Ä–æ–π–≤–∞–µ–º–∞)
   - 60 –º–∏–Ω—É—Ç–∏ cooldown (–Ω–∞—Å—Ç—Ä–æ–π–≤–∞–µ–º)
   - 4 —á–∞—Å–∞ –∑–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏

---

## üìù –§–ò–ù–ê–õ–ï–ù –ü–õ–ê–ù –ó–ê –ë–ï–ó–û–ü–ê–°–ù–ê –ü–†–û–ú–Ø–ù–ê

### –°—Ç—ä–ø–∫–∞ 1: Backup

```bash
# –°—ä–∑–¥–∞–π backup –Ω–∞ bot.py
cp bot.py bot.py.backup_$(date +%Y%m%d_%H%M%S)

# Backup –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Ç–∞ (–∞–∫–æ –∏–º–∞)
cp bot_stats.json bot_stats.json.backup_$(date +%Y%m%d_%H%M%S) 2>/dev/null || true
```

### –°—Ç—ä–ø–∫–∞ 2: –ü—Ä–æ–º–µ–Ω–∏ –≤ –∫–æ–¥–∞

**–§–∞–π–ª:** `bot.py`

#### –ü—Ä–æ–º—è–Ω–∞ 1: –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ (line 419)

**–ü–†–ï–î–ò:**
```python
def is_signal_already_sent(symbol, signal_type, timeframe, confidence, cooldown_minutes=60):
```

**–°–õ–ï–î:**
```python
def is_signal_already_sent(symbol, signal_type, timeframe, confidence, entry_price, cooldown_minutes=60):
```

#### –ü—Ä–æ–º—è–Ω–∞ 2: –õ–æ–≥–∏–∫–∞ –∑–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ (line 432-466)

**–ü–†–ï–î–ò:**
```python
global SENT_SIGNALS_CACHE

signal_key = f"{symbol}_{signal_type}_{timeframe}"
current_time = datetime.now()

if signal_key in SENT_SIGNALS_CACHE:
    last_sent_time = SENT_SIGNALS_CACHE[signal_key]['timestamp']
    last_confidence = SENT_SIGNALS_CACHE[signal_key]['confidence']
    
    time_diff = (current_time - last_sent_time).total_seconds() / 60
    
    if time_diff < cooldown_minutes:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: –ò–∑–ø—Ä–∞—Ç–µ–Ω –ø—Ä–µ–¥–∏ {time_diff:.1f} –º–∏–Ω (cooldown: {cooldown_minutes} –º–∏–Ω)")
        return True
    
    if abs(confidence - last_confidence) < 5 and time_diff < cooldown_minutes * 2:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: –°—ä—â–∏—è confidence ({confidence}% vs {last_confidence}%)")
        return True

SENT_SIGNALS_CACHE[signal_key] = {
    'timestamp': current_time,
    'confidence': confidence
}
```

**–°–õ–ï–î:**
```python
global SENT_SIGNALS_CACHE

signal_key = f"{symbol}_{signal_type}_{timeframe}"
current_time = datetime.now()

if signal_key in SENT_SIGNALS_CACHE:
    last_sent_time = SENT_SIGNALS_CACHE[signal_key]['timestamp']
    last_confidence = SENT_SIGNALS_CACHE[signal_key]['confidence']
    last_price = SENT_SIGNALS_CACHE[signal_key]['entry_price']
    
    time_diff = (current_time - last_sent_time).total_seconds() / 60
    price_diff_pct = abs((entry_price - last_price) / last_price) * 100
    confidence_diff = abs(confidence - last_confidence)
    
    # –ü–†–ê–í–ò–õ–û 1: Cooldown + –±–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞
    if time_diff < cooldown_minutes and price_diff_pct < 0.5:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: Cooldown ({time_diff:.1f}m) + Price close ({price_diff_pct:.2f}%)")
        return True
    
    # –ü–†–ê–í–ò–õ–û 2: –ú–Ω–æ–≥–æ –±–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞ –≤ 2h
    if price_diff_pct < 0.2 and time_diff < cooldown_minutes * 2:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: Price very close ({price_diff_pct:.2f}%) within 2h")
        return True
    
    # –ü–†–ê–í–ò–õ–û 3: –ü–æ–¥–æ–±–µ–Ω confidence + –±–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞
    if confidence_diff < 5 and price_diff_pct < 1.0 and time_diff < cooldown_minutes * 1.5:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: Similar signal (Œîconf={confidence_diff:.1f}%, Œîprice={price_diff_pct:.2f}%)")
        return True
    
    # –ü–†–ê–í–ò–õ–û 4: –ò–¥–µ–Ω—Ç–∏—á–µ–Ω —Å–∏–≥–Ω–∞–ª –≤ 4h
    if confidence_diff < 3 and price_diff_pct < 0.3 and time_diff < 240:
        logger.info(f"‚è≠Ô∏è Skip {signal_key}: Almost identical within 4h")
        return True

SENT_SIGNALS_CACHE[signal_key] = {
    'timestamp': current_time,
    'confidence': confidence,
    'entry_price': entry_price
}
```

#### –ü—Ä–æ–º—è–Ω–∞ 3: –ò–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ (line 7080)

**–ü–†–ï–î–ò:**
```python
if is_signal_already_sent(symbol, analysis['signal'], timeframe, analysis['confidence'], cooldown_minutes=60):
    return None
```

**–°–õ–ï–î:**
```python
if is_signal_already_sent(symbol, analysis['signal'], timeframe, analysis['confidence'], analysis['price'], cooldown_minutes=60):
    return None
```

### –°—Ç—ä–ø–∫–∞ 3: –¢–µ—Å—Ç–≤–∞–Ω–µ

#### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
```bash
python3 -m py_compile bot.py
```

#### –¢–µ—Å—Ç 2: Dry-run (–∞–∫–æ –∏–º–∞)
```bash
# –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞–ª–∏ –±–æ—Ç—ä—Ç —Å—Ç–∞—Ä—Ç–∏—Ä–∞ –±–µ–∑ –≥—Ä–µ—à–∫–∏
python3 bot.py --dry-run  # –ê–∫–æ –µ –ø–æ–¥–¥—ä—Ä–∂–∞–Ω–æ
```

#### –¢–µ—Å—Ç 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –ª–æ–≥–æ–≤–µ—Ç–µ
```bash
# –°—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞ –∏ —Å–ª–µ–¥–∏ –ª–æ–≥–æ–≤–µ—Ç–µ
tail -f /path/to/bot.log | grep -E "Skip|New signal|Price"
```

**–û—á–∞–∫–≤–∞–Ω–∏ –ª–æ–≥–æ–≤–µ:**
```
‚úÖ New signal: BTCUSDT_SELL_4h @ $97100.00 (75%)
‚è≠Ô∏è Skip BTCUSDT_SELL_4h: Cooldown (15.3m) + Price close (0.05%)
‚è≠Ô∏è Skip BTCUSDT_SELL_4h: Price very close (0.18%) within 2h
‚úÖ New signal: BTCUSDT_SELL_4h @ $95200.00 (80%)  # –ó–Ω–∞—á–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–º—è–Ω–∞ –≤ —Ü–µ–Ω–∞—Ç–∞
```

### –°—Ç—ä–ø–∫–∞ 4: Rollback (–∞–∫–æ –∏–º–∞ –ø—Ä–æ–±–ª–µ–º)

```bash
# –í—ä–∑—Å—Ç–∞–Ω–æ–≤–∏ backup
cp bot.py.backup_YYYYMMDD_HHMMSS bot.py

# –†–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–π –±–æ—Ç–∞
systemctl restart crypto-signal-bot
# –ò–õ–ò
pm2 restart bot
```

---

## ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò –ò –ü–ê–†–ê–ú–ï–¢–†–ò

### –ü—Ä–æ–º–µ–Ω–ª–∏–≤–∏ –∑–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```python
# –í is_signal_already_sent() —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞

# –¶–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç (–ø—Ä–æ—Ü–µ–Ω—Ç)
PRICE_TOLERANCE_STRICT = 0.2    # –ú–Ω–æ–≥–æ –±–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞ (–±–ª–æ–∫–∏—Ä–∞ –≤ 2h)
PRICE_TOLERANCE_NORMAL = 0.5    # –ë–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞ (–±–ª–æ–∫–∏—Ä–∞ –≤ cooldown)
PRICE_TOLERANCE_LOOSE = 1.0     # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª–Ω–æ –±–ª–∏–∑–∫–∞ —Ü–µ–Ω–∞ (–±–ª–æ–∫–∏—Ä–∞ –∞–∫–æ confidence –µ —Å—ä—â)
PRICE_TOLERANCE_IDENTICAL = 0.3 # –ò–¥–µ–Ω—Ç–∏—á–Ω–∞ —Ü–µ–Ω–∞ (–±–ª–æ–∫–∏—Ä–∞ –≤ 4h)

# –í—Ä–µ–º–µ –∑–∞ cooldown (–º–∏–Ω—É—Ç–∏)
COOLDOWN_DEFAULT = 60           # –ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ
COOLDOWN_EXTENDED = 120         # –£–¥—ä–ª–∂–µ–Ω (2x)
COOLDOWN_IDENTICAL = 240        # –ó–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏ (4h)

# Confidence —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç (–ø—Ä–æ—Ü–µ–Ω—Ç)
CONFIDENCE_TOLERANCE_STRICT = 3 # –ò–¥–µ–Ω—Ç–∏—á–µ–Ω confidence
CONFIDENCE_TOLERANCE_NORMAL = 5 # –ü–æ–¥–æ–±–µ–Ω confidence
```

### –ü—Ä–∏–º–µ—Ä–∏ –∑–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è 1: –ü–æ-—Å—Ç—Ä–æ–≥–∞ (–ø–æ-–º–∞–ª–∫–æ —Å–∏–≥–Ω–∞–ª–∏)
```python
# –ü–æ-–≥–æ–ª—è–º–∞ —Ü–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç + –ø–æ-–¥—ä–ª—ä–≥ cooldown
PRICE_TOLERANCE_NORMAL = 1.0  # –≤–º–µ—Å—Ç–æ 0.5
COOLDOWN_DEFAULT = 90         # –≤–º–µ—Å—Ç–æ 60
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è 2: –ü–æ-–ª–∏–±–µ—Ä–∞–ª–Ω–∞ (–ø–æ–≤–µ—á–µ —Å–∏–≥–Ω–∞–ª–∏)
```python
# –ü–æ-–º–∞–ª–∫–∞ —Ü–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç + –ø–æ-–∫—Ä–∞—Ç—ä–∫ cooldown
PRICE_TOLERANCE_NORMAL = 0.3  # –≤–º–µ—Å—Ç–æ 0.5
COOLDOWN_DEFAULT = 45         # –≤–º–µ—Å—Ç–æ 60
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è 3: Balanced (–ø—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–∞)
```python
# –¢–µ–∫—É—â–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ —Å–∞ balanced
PRICE_TOLERANCE_NORMAL = 0.5
COOLDOWN_DEFAULT = 60
```

---

## üß™ –¢–ï–°–¢ –°–¶–ï–ù–ê–†–ò–ò

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏

**–í—Ö–æ–¥:**
- 10:00 - BTCUSDT SELL 4h @ $97100 (75%)
- 10:15 - BTCUSDT SELL 4h @ $97095 (76%)
- 10:30 - BTCUSDT SELL 4h @ $97102 (74%)

**–û—á–∞–∫–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç:**
- 10:00 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (–Ω–æ–≤ —Å–∏–≥–Ω–∞–ª)
- 10:15 ‚ùå –ë–õ–û–ö–ò–†–ê–ù (cooldown + —Ü–µ–Ω–∞ –±–ª–∏–∑–∫–∞ 0.05%)
- 10:30 ‚ùå –ë–õ–û–ö–ò–†–ê–ù (cooldown + —Ü–µ–Ω–∞ –±–ª–∏–∑–∫–∞ 0.02%)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ó–Ω–∞—á–∏—Ç–µ–ª–Ω–∞ –ø—Ä–æ–º—è–Ω–∞ –≤ —Ü–µ–Ω–∞—Ç–∞

**–í—Ö–æ–¥:**
- 10:00 - BTCUSDT SELL 4h @ $97100 (75%)
- 10:30 - BTCUSDT SELL 4h @ $95000 (78%)

**–û—á–∞–∫–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç:**
- 10:00 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (–Ω–æ–≤ —Å–∏–≥–Ω–∞–ª)
- 10:30 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (—Ü–µ–Ω–∞—Ç–∞ —Å–µ –µ –ø—Ä–æ–º–µ–Ω–∏–ª–∞ —Å 2.2%)

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Cooldown –∏–∑—Ç–µ–∫—ä–ª, –Ω–æ —Ü–µ–Ω–∞—Ç–∞ –µ —Å—ä—â–∞—Ç–∞

**–í—Ö–æ–¥:**
- 10:00 - BTCUSDT SELL 4h @ $97100 (75%)
- 11:15 - BTCUSDT SELL 4h @ $97102 (76%)

**–û—á–∞–∫–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç:**
- 10:00 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (–Ω–æ–≤ —Å–∏–≥–Ω–∞–ª)
- 11:15 ‚ùå –ë–õ–û–ö–ò–†–ê–ù (price_diff 0.02% < 0.2%, –≤ —Ä–∞–º–∫–∏—Ç–µ –Ω–∞ 2h)

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–∞–∑–ª–∏—á–µ–Ω confidence, —Å—ä—â–∞—Ç–∞ —Ü–µ–Ω–∞

**–í—Ö–æ–¥:**
- 10:00 - BTCUSDT SELL 4h @ $97100 (70%)
- 10:45 - BTCUSDT SELL 4h @ $97100 (85%)

**–û—á–∞–∫–≤–∞–Ω —Ä–µ–∑—É–ª—Ç–∞—Ç:**
- 10:00 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (–Ω–æ–≤ —Å–∏–≥–Ω–∞–ª)
- 10:45 ‚úÖ –ò–ó–ü–†–ê–¢–ï–ù (confidence –µ —Å–∫–æ—á–∏–ª —Å 15%, –≤—ä–ø—Ä–µ–∫–∏ —á–µ —Ü–µ–Ω–∞—Ç–∞ –µ —Å—ä—â–∞—Ç–∞)

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –û—Å–Ω–æ–≤–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –∑–∞ –ø—Ä–æ–±–ª–µ–º–∞:

**–¶–µ–Ω–∞—Ç–∞ –Ω–µ —Å–µ –≤–∑–∏–º–∞ –ø–æ–¥ –≤–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ.**

### –†–µ—à–µ–Ω–∏–µ:

**–î–æ–±–∞–≤—è–Ω–µ –Ω–∞ —Ü–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç (0.2-1%) –≤ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ç–∞ –∑–∞ –¥—É–±–ª–∏—Ä–∞–Ω–µ.**

### –û—á–∞–∫–≤–∞–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ —Å–ª–µ–¥ –ø—Ä–æ–º—è–Ω–∞—Ç–∞:

1. ‚úÖ –ù–∞–º–∞–ª—è–≤–∞–Ω–µ –Ω–∞ –¥—É–±–ª–∏—Ä–∞–Ω–∏—Ç–µ —Å–∏–≥–Ω–∞–ª–∏ —Å **70-80%**
2. ‚úÖ –ü–æ-—á–∏—Å—Ç–∏ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å–∞–º–æ –∑–Ω–∞—á–∏—Ç–µ–ª–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏)
3. ‚úÖ –ü–æ-–¥–æ–±—Ä–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ cooldown
4. ‚úÖ –ó–∞—â–∏—Ç–∞ —Å—Ä–µ—â—É micro-variations –≤ —Ü–µ–Ω–∞—Ç–∞

### –†–∏—Å–∫–æ–≤–µ:

1. ‚ö†Ô∏è –ú–æ–∂–µ –¥–∞ –ø—Ä–æ–ø—É—Å–Ω–µ –≤–∞–ª–∏–¥–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏ –ø—Ä–∏ –±—ä—Ä–∑–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ —Ü–µ–Ω–∞—Ç–∞ (< 0.5%)
   - **–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π–≤–∞–µ–º–∏ –ø—Ä–∞–≥–æ–≤–µ
2. ‚ö†Ô∏è –ú–æ–∂–µ –¥–∞ –±–ª–æ–∫–∏—Ä–∞ –ª–µ–≥–∏—Ç–∏–º–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏ –ø—Ä–∏ –≤–æ–ª–∞—Ç–∏–ª–Ω–æ—Å—Ç
   - **–†–µ—à–µ–Ω–∏–µ:** –ü–æ-–≥–æ–ª—è–º–∞ —Ü–µ–Ω–æ–≤–∞ —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç (1% –≤–º–µ—Å—Ç–æ 0.5%)

### –ü—Ä–µ–ø–æ—Ä—ä–∫–∞:

**–ó–ê–ü–û–ß–ù–ò –° BALANCED –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø** (0.5% —Ç–æ–ª–µ—Ä–∞–Ω—Ç–Ω–æ—Å—Ç, 60 –º–∏–Ω cooldown) –∏ –Ω–∞–±–ª—é–¥–∞–≤–∞–π —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ 24-48 —á–∞—Å–∞. –°–ª–µ–¥ —Ç–æ–≤–∞ –Ω–∞—Å—Ç—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ —Å–ø–æ—Ä–µ–¥ –Ω—É–∂–¥–∏—Ç–µ.

---

**–°–¢–ê–¢–£–°:** ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞—Ç–∞ –µ –∑–∞–≤—ä—Ä—à–µ–Ω–∞. –ß–∞–∫–∞–º –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –∑–∞ –ø—Ä–æ–º—è–Ω–∞.
